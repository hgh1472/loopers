# 상품 목록 조회

## 기능적 요구사항

### < Happy Cases >

- 상품 목록에서 여러 상품에 대한 정보를 확인할 수 있다.
    - 각 상품에 대한 정보는 브랜드 이름, 상품 이름, 상품 좋아요 수, 가격, 판매 상태, 좋아요 여부를 반환해야 한다.
- 사용자는 이미 ‘좋아요’한 상품인지 확인할 수 있다.
- 특정 브랜드의 상품만 필터링하여 조회할 수 있다.
- 상품 카테고리를 지정하여 조회할 수 있다.
- 상품 목록을 최신순, 가격 낮은 순, ‘좋아요’ 많은 순으로 조회한다.
- 사용자는 페이지 별로 상품 목록을 확인할 수 있다.
    - 사용자는 페이지 사이즈, 페이지 위치를 지정할 수 있다.

---

### < Constraints >

- 로그인하지 않은 경우, ‘좋아요’하지 않은 상태로 상품을 나타낸다.
- 존재하지 않는 브랜드로 상품 목록을 필터링할 경우, 빈 목록을 반환한다.
- 정렬 조건을 지정하지 않거나 잘못된 정렬 조건일 경우, 최신순으로 조회한다.
- 페이지를 지정하지 않으면, 첫번째 페이지를 조회한다.
- 페이지 사이즈를 지정하지 않으면, 10개를 기본으로 조회한다.

---

### < Fail Cases >

- 사용자가 최대 페이지 사이즈(30)를 초과한다면, 오류를 반환한다.
- 유효하지 않은 카테고리를 지정할 경우, 오류를 반환한다.

## 비기능적 요구사항

- 사용자 인증은 `X-USER-ID` 헤더를 기반으로 처리한다.

| 예외 케이스 | 설명 | HTTP 상태코드 |
| --- | --- | --- |
| 페이지 당 상품 수 초과 | 페이지 사이즈 30 초과 | 400 Bad Request |
| 존재하지 않는 카테고리 | 존재하지 않는 카테고리 | 404 Not Found |

# 상품 상세 조회

## 기능적 요구사항

### < Happy Cases >

- 사용자는 상품 상세를 조회할 수 있다.
    - 사용자는 브랜드 이름, 상품 이름, 가격, ‘좋아요’ 수, ‘좋아요’ 여부, 카테고리, 재고, 판매 여부를 제공한다.
- 사용자는 ‘좋아요’한 상품인지 확인할 수 있다.
- 판매 중단된 상품도 조회할 수 있다.

---

### < Constraints >

- 사용자가 로그인하지 않은 상태라면, ‘좋아요’하지 않은 상태로 나타낸다.

---

### < Fail Cases >

- 존재하지 않는 상품 정보를 조회한다면, 오류를 반환한다.

## 비기능적 요구사항

- 사용자 인증은 `X-USER-ID` 헤더를 기반으로 처리한다.

| 예외 케이스 | 설명 | HTTP 상태코드 |
| --- | --- | --- |
| 존재하지 않는 상품 | 존재하지 않는 productId | 404 Bad Request |

# 브랜드 조회

## 기능적 요구사항

### < Happy Cases >

- 사용자는 브랜드 정보를 조회할 수 있다.
    - 사용자는 브랜드 이름, 설명, 브랜드 상품 중 ‘좋아요’ 많은 순/최신순 상품 각 5개를 제공한다.
- 브랜드 내 보여지는 상품들은 브랜드 이름, 상품 이름, 상품 좋아요 수, 가격, 판매 여부, 좋아요 여부 정보를 확인할 수 있다.
    - 브랜드 내 상품이 없다면, 빈 상품 목록을 반환한다.

---

### < Contraints >

---

### < Fail Cases >

- 존재하지 않는 브랜드를 조회한다면, 오류를 반환한다.

## 비기능적 요구사항

- 사용자 인증은 `X-USER-ID` 헤더를 기반으로 처리한다.

| 예외 케이스 | 설명 | HTTP 상태코드 |
| --- | --- | --- |
| 존재하지 않는 브랜드 | 존재하지 않는 brandId | 404 Bad Request |

# 상품 좋아요 등록/취소

## 기능적 요구사항

### < Happy Cases >

- 로그인한 사용자는 상품에 ‘좋아요’를 등록할 수 있다.
- 기존에 ‘좋아요’한 상품을 취소할 수 있다.
- 판매 중단된 상품도 좋아요 등록/취소할 수 있다.

---

### < Constraints >

---

### < Fail Cases >

- 로그인하지 않은 사용자라면, 오류를 반환한다.
- 존재하지 않는 상품이라면, 오류를 반환한다.
- 이미 ‘좋아요’한 상품을 다시 ‘좋아요’ 등록 시도한다면, 오류를 반환한다.
- ‘좋아요’하지 않은 상품을 ‘좋아요’ 취소하려고 한다면, 오류를 반환한다.

## 비기능적 요구사항

- 사용자 인증은 `X-USER-ID` 헤더를 기반으로 처리한다.

| 예외 케이스 | 설명 | HTTP 상태코드 |
| --- | --- | --- |
| 미로그인 | 인증 헤더 없음 | 존재하지 않는 유저 | 401 Unauthroized |
| 상품 미존재 | 존재하지 않는 productId | 404 Not Found |
| 중복 ‘좋아요’ 취소 또는 등록 | ‘좋아요’한 상품 ‘좋아요’ 등록 시도 | ‘좋아요’하지 않은 상품 ‘좋아요’ 취소 시도 | 409 Conflict |

# 내가 좋아요한 상품 목록 조회

## 기능적 요구사항

### < Haapy Cases >

- 사용자는 좋아요한 상품 목록을 조회할 수 있다.
    - 각 상품에 대한 정보는 브랜드 이름, 상품 이름, 상품 좋아요 수, 가격, 판매 상태, 좋아요 여부를 확인할 수 있다.
- 상품은 담은 순, 낮은 가격순으로 조회할 수 있다.
- 좋아요한 상품 목록을 페이지 별로 볼 수 있다.

---

### < Constraints >

- 정렬 조건을 지정하지 않거나 잘못된 정렬 조건일 경우, 담은 순으로 조회한다.
- 페이지를 지정하지 않으면, 첫번째 페이지를 조회한다.
- 페이지 사이즈를 지정하지 않으면, 10개를 기본으로 조회한다.

---

### < Fail Cases >

- 로그인하지 않은 유저라면, 오류를 반환한다.
- 사용자가 최대 페이지 사이즈(30)를 초과한다면, 오류를 반환한다.

## 비기능적 요구사항

- 사용자 인증은 `X-USER-ID` 헤더를 기반으로 처리한다.

| 예외 케이스 | 설명 | HTTP 상태코드 |
| --- | --- | --- |
| 미로그인 | 인증 헤더 없음 | 존재하지 않는 유저 | 401 Unauthroized |
| 페이지 당 상품 수 초과 | 페이지 사이즈 30 초과 | 400 Bad Request |

# 주문 생성 및 결제 흐름

## 기능적 요구사항

### < Happy Cases >

- 로그인한 사용자는 상품들을 주문할 수 있다.
- 사용자는 주문할 때 각 상품의 수량을 지정할 수 있다.
- 사용자는 주문할 때 배송 정보를 입력한다.
- 결제 시, 소유한 포인트를 사용할 수 있다.
- 결제에 성공하면, 상품의 재고가 주문 수량만큼 감소된다.
- 결제에 성공하면, 포인트 사용 내역이 기록된다.

---

### < Constraints >

---

### < Fail Cases >

- 로그인하지 않은 사용자에게 오류를 반환한다.
- 상품이 존재하지 않으면, 오류를 반환한다.
- 상품이 판매중이 아닐 경우, 오류를 반환한다.
- 사용하려는 포인트가 부족한 경우, 오류를 반환한다.
- 이미 결제한 주문인 경우, 오류를 반환한다.
- 잔액이 부족할 경우, 오류를 반환한다.
- 결제에 실패한다면, 주문은 ‘결제 오류’상태로 기록된다.
- 상품 재고가 부족한 경우, 환불 처리한다.

## 비기능적 요구사항

- 사용자 인증은 `X-USER-ID` 헤더를 기반으로 처리한다.

| 예외 케이스 | 설명 | HTTP 상태코드 |
| --- | --- | --- |
| 미로그인 | 인증 헤더 없음 | 존재하지 않는 유저 | 401 Unauthroized |
| 상품 미존재 | 존재하지 않는 productId | 404 Not Found |
| 상품 판매중 아님 | 상품의 상태가 판매중이 아닌 상태 | 409 Conflict |
| 포인트 부족 | 사용하려는 포인트가 부족한 상태 | 409 Conflict |
| 중복 결제 | 이미 결제한 주문 재결제 시도 | 400 Bad Request |
| 결제 잔액 부족 | 잔고 부족으로 인한 결제 실패 | 403 Forbidden |
| 결제 실패 | 결제 시스템 문제로 인한 실패 | 500 Internal Server Error |
| 상품 재고 부족 | 상품 재고 < 주문 수량 | 409 Conflict |

# 유저의 주문 목록 조회

## 기능적 요구사항

### < Happy Cases >

- 사용자의 주문 목록을 조회할 수 있다.
    - 각 주문은 총 금액, 주문 날짜, 주문 상태, 상품 브랜드 이름, 상품 이름, 상품 개수, 주문 라인 별 가격을 보여준다.
- 주문 목록은 최신순으로 조회된다.
- 주문 목록은 페이지 단위로 확인할 수 있다.

---

### < Constraints >

- 페이지 사이즈를 지정하지 않을 경우, 한 페이지 당 15개 주문을 조회한다.

---

### < Fail Cases >

- 로그인 사용자가 아닐 경우, 오류를 반환한다.
- 사용자가 최대 페이지 사이즈(30)를 초과한다면, 오류를 반환한다.

## 비기능적 요구사항

- 사용자 인증은 `X-USER-ID` 헤더를 기반으로 처리한다.

| 예외 케이스 | 설명 | HTTP 상태코드 |
| --- | --- | --- |
| 미로그인 | 인증 헤더 없음 | 존재하지 않는 유저 | 401 Unauthroized |

# 단일 주문 상세 조회

## 기능적 요구사항

### < Happy Cases >

- 사용자는 단일 주문 상세 정보를 조회할 수 있다.
    - 단일 주문 상세 정보에는 주문 번호, 배송 정보, 주문 상품, 상품 별 금액, 총 금액을 확인할 수 있다.

---

### < Constraints >

---

### < Fail Cases >

- 로그인 사용자가 아닐 경우, 오류를 반환한다.
- 로그인 사용자의 주문이 아닐 경우, 오류를 반환한다.
- 존재하지 않는 주문일 경우, 오류를 반환한다.

## 비기능적 요구사항

- 사용자 인증은 `X-USER-ID` 헤더를 기반으로 처리한다.

| 예외 케이스 | 설명 | HTTP 상태코드 |
| --- | --- | --- |
| 미로그인 | 인증 헤더 없음 | 존재하지 않는 유저 | 401 Unauthroized |
| 로그인 사용자의 주문 X | 다른 사용자의 주문 | 403 Forbidden |
| 존재하지 않는 주문 | 존재하지 않는 주문 번호 | 404 Not Found |